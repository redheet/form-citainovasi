<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GSIC Registration Form</title>
    <link
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@7.12.15/dist/sweetalert2.all.min.js"></script>
    <style>
      html {
        scroll-behavior: smooth;
      }
      body {
        background: linear-gradient(120deg, #f6f9fc, #e9f5ff);
        font-family: "Segoe UI", sans-serif;
      }

      .form-container {
        animation: slideUp 0.5s ease-in-out;
      }

      @keyframes slideUp {
        0% {
          opacity: 0;
          transform: translateY(30px);
        }
        100% {
          opacity: 1;
          transform: translateY(0);
        }
      }

      textarea {
        resize: none;
      }
      .form-container {
        max-width: 500px;
        margin: auto;
        margin-top: 50px;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        background-color: #fff;
      }
    </style>
    <!-- Bootstrap 5 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Animate.css -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
  </head>
  <body class="bg-light">
    <div class="container-lg py-5">
      <div class="form-container bg-white p-4 rounded shadow">
        <h4 class="text-center mb-4">Form Registration GSIC</h4>
        <form id="submit-to-google-sheet">
          <div class="form-group wow fadeInUp" data-wow-delay="0.2s">
            <label for="school">School Name</label>
            <input
              class="form-control"
              type="text"
              name="school"
              id="school"
              placeholder="Your School Name"
              required
            />
          </div>
          <div class="form-group">
            <label for="country">Country</label>
            <input
              class="form-control"
              type="text"
              name="country"
              id="country"
              placeholder="Your Country"
              required
            />
          </div>
          <div class="form-group">
            <label for="leader_name">Leader Name</label>
            <input
              class="form-control"
              type="text"
              name="name"
              id="name"
              placeholder="Leader Team Name"
              required
            />
          </div>
          <div class="form-group">
            <label for="email">Email Leader</label>
            <input
              class="form-control"
              type="email"
              name="email"
              id="email"
              placeholder="example@gmail.com"
              required
            />
          </div>
          <div class="form-group">
            <label for="number">Whatsapp Number</label>
            <input
              class="form-control"
              type="text"
              name="contact_number"
              id="contact_number"
              placeholder="Example: +1234567890"
              required
            />
          </div>
          <div class="form-group">
            <label for="team_name_1">Member Name 1</label>
            <input
              class="form-control"
              type="text"
              name="team_1"
              id="team_1"
              placeholder="use ( - ) for empty"
              required
            />
          </div>
          <div class="form-group">
            <label for="team_name_2">Member Name 2</label>
            <input
              class="form-control"
              type="text"
              name="team_2"
              id="team_2"
              placeholder="use ( - ) for empty"
              required
            />
          </div>
          <div class="form-group">
            <label for="teacher_name">Teacher Name</label>
            <input
              class="form-control"
              type="text"
              name="teacher_name"
              id="teacher_name"
              placeholder="Teacher Name"
              required
            />
          </div>
          <div class="form-group">
            <label for="teacher_number">Teacher Number</label>
            <input
              class="form-control"
              type="text"
              name="teacher_number"
              id="teacher_number"
              placeholder="Example: +1234567890"
              required
            />
          </div>
          <div class="form-group">
            <label for="teacher_email">Teacher Email</label>
            <input
              class="form-control"
              type="text"
              name="teacher_email"
              id="teacher_email"
              placeholder="Teacher Email"
              required
            />
          </div>
          <div class="form-group">
            <label for="loc">Categories</label>
            <select
              class="form-control"
              name="categories"
              id="categories"
              required
            >
              <option value="" disabled selected hidden>Choose...</option>
              <option value="environmental">Environmental</option>
              <option value="renewable energy">Renewable Energy</option>
              <option value="waste management">Waste Management</option>
              <option value="sustainable agriculture">
                Sustainable Agriculture
              </option>
              <option value="convenient design for daily life">
                Convenient Design for Daily Life
              </option>
            </select>
          </div>
          <!-- <div class="form-group">
            <label for="loc">Presentation Online</label>
            <select
              class="form-control"
              name="presentation_online"
              id="presentation_online"
              required
            >
              <option value="" disabled selected hidden>Choose...</option>
              <option value="Round 1">Round 1</option>
              <option value="Round 2">Round 2</option>
            </select>
          </div> -->
          <div class="form-group">
            <label for="research_title">Research Title</label>
            <textarea
              class="form-control"
              name="research_title"
              id="research_title"
              placeholder="Research Title"
              required
            ></textarea>
          </div>
          <div class="form-group">
            <label for="research_abstract">Research Abstract</label>
            <textarea
              class="form-control"
              name="research_abstract"
              id="research_abstract"
              placeholder="Research Abstract"
              required
            ></textarea>
          </div>

          <div class="form-group mt-2">
            <label for="media" class="form-check-label mb-2"
              >Extended Abstract
            </label>
            <input
              class="form-control-file"
              type="file"
              name="media"
              id="media"
            />
          </div>

          <!-- tambahan upload file  -->
          <div class="form-group mt-4">
            <label for="media_2" class="form-check-label mb-2"
              >Business Plan</label
            >
            <input
              class="form-control-file"
              type="file"
              name="media_2"
              id="media_2"
            />
          </div>
          <div class="form-group mt-4">
            <label for="media_3" class="form-check-label mb-2"
              >Research Photo</label
            >
            <input
              class="form-control-file"
              type="file"
              name="media_3"
              id="media_3"
            />
          </div>

          <div class="form-group form-check mt-4">
            <input class="form-check-input" type="checkbox" id="complete" />
            <label class="form-check-label" for="complete"
              >Check if you are complete the form</label
            >
          </div>

          <div class="form-group form-check">
            <input
              class="form-check-input"
              type="checkbox"
              id="data"
              required
            />
            <label class="form-check-label" for="data"
              >By checking this box I certify that I am agree with the data
              terms and policies.
            </label>
          </div>
          <button type="submit" class="btn btn-primary btn-block">
            Submit
          </button>
        </form>
      </div>
    </div>

    <script>
      const scriptURL =
        "https://script.google.com/macros/s/AKfycbyyHfVyucTk-zQmn7AS3UchQM-AGdS9kgi-LgYDKfWApQx2GujZullH16WEIIyJtUlo/exec";
      const form = document.forms["submit-to-google-sheet"];

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const formData = new FormData(form);
        var data = document.getElementById("data").checked;
        var complete = document.getElementById("complete").checked;

        formData.append("complete", complete ? "Yes" : "No");
        formData.append("data", data ? "Yes" : "No");

        // Handle the file upload
        const fileFields = ["media", "media_2", "media_3"];
        let filesProcessed = 0;

        fileFields.forEach((fieldName) => {
          const fileInput = document.getElementById(fieldName);
          if (fileInput && fileInput.files.length > 0) {
            const file = fileInput.files[0];
            const reader = new FileReader();

            if (file.size > 50 * 1024 * 1024) {
              swal(
                "Error",
                `${fieldName} size should be less than 50MB.`,
                "error"
              );
              return;
            }

            reader.onload = function () {
              formData.append(fieldName, reader.result.split(",")[1]); // Base64
              formData.append(`${fieldName}_filename`, file.name);

              filesProcessed++;
              if (filesProcessed === fileFields.length) {
                submitForm(formData);
              }
            };

            reader.readAsDataURL(file);
          } else {
            filesProcessed++;
            if (filesProcessed === fileFields.length) {
              submitForm(formData);
            }
          }
        });
      });

      async function submitForm(formData) {
        // Get the submit button and change its text to "Loading..."
        const submitButton = document.querySelector("button[type='submit']");
        submitButton.disabled = true;
        submitButton.innerText = "Loading...";

        // Submit the form data to the Google Sheet
        fetch(scriptURL, { method: "POST", body: formData })
          .then((response) => {
            swal("Done", "Submitted Successfully.", "success");
            form.reset();
          })
          .catch((error) => {
            swal("Error", "Something went wrong. Please try again!", "error");
          })
          .finally(() => {
            // Reset the submit button back to "Submit"
            submitButton.disabled = false;
            submitButton.innerText = "Submit";
          });
      }
    </script>
    <!-- WOW.js for scroll animation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js"></script>
    <script>
      new WOW().init();
    </script>
  </body>
</html>
